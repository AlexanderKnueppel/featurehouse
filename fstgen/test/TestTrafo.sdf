module declare

imports
  include/MoBL
  normalize
  lib/editor-common
  type

strategies
  declare-all =
    with(
      (?Module(_, def*) <+ ?Application(_, def*) <+ ?ServerApplication(_, _, def*))
      ; <filter(origin-track-forced(declare))> def*
    )

  // Records the definition of an entity in a dynamic rule GetEntity.
  declare:
    Entity(_, qid, super, body) -> <id>
    with
      extern := <origin-track-forced(definition-to-external)>
      ; rules(
          GetEntity : qid -> extern
        )